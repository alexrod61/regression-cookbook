<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Binary Logistic Regression – The Regression Cookbook (in development)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../book/09-binomial-logistic.html" rel="next">
<link href="../book/discrete-zone.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-c102d61e9f42aa51f65b68241b633b47.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../custom.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">The Regression Cookbook (in development)</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="https://github.com/alexrod61/regression-cookbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/discrete-zone.html">Discrete Cuisine</a></li><li class="breadcrumb-item"><a href="../book/08-binary-logistic.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binary Logistic Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../img/cookbook.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/privacy-policy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Website Privacy Policy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/audience-scope.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Audience and Scope</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Ready for Regression Cooking!</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/02-stats-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Cuisine: A Review on Probability and Frequentist Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book/continuous-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous Cuisine</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/03-ols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Zestylicious Ordinary Least-squares Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/04-gamma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Smoketastic Gamma Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/05-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Soup-erb Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/06-parametric-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Crunchified Parametric Survival Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/07-semiparametric-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Butteryfied Semiparametric Survival Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../book/discrete-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete Cuisine</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/08-binary-logistic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binary Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/09-binomial-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Cheesified Binomial Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/10-classical-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Bubblarious Classical Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/11-negative-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Umami-zing Negative Binomial Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/12-zero-inflated-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Spicetacular Zero-Inflated Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/13-generalized-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Herbalicious Generalized Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/14-multinomial-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Picklified Multinomial Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/15-ordinal-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Tang-tastic Ordinal Logistic Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/A-dictionary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">The Fusionified ML-Stats Dictionary</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/B-greek-alphabet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">The Snazzalicious Greek Alphabet</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/C-distributional-mind-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">The Chocolified Distributional Mind Map</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/D-regression-mind-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">The Sugartastic Regression Mind Map</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">The recipe</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">8.1</span> Introduction</a></li>
  <li><a href="#why-ordinary-least-squares-fails-for-binary-outcomes" id="toc-why-ordinary-least-squares-fails-for-binary-outcomes" class="nav-link" data-scroll-target="#why-ordinary-least-squares-fails-for-binary-outcomes"><span class="header-section-number">8.2</span> Why Ordinary Least Squares Fails for Binary Outcomes</a></li>
  <li>
<a href="#the-logit-function" id="toc-the-logit-function" class="nav-link" data-scroll-target="#the-logit-function"><span class="header-section-number">8.3</span> The Logit Function</a>
  <ul>
<li><a href="#logit-a-link-between-probability-and-linear-predictors" id="toc-logit-a-link-between-probability-and-linear-predictors" class="nav-link" data-scroll-target="#logit-a-link-between-probability-and-linear-predictors"><span class="header-section-number">8.3.1</span> Logit: A Link Between Probability and Linear Predictors</a></li>
  <li><a href="#from-log-odds-back-to-probability" id="toc-from-log-odds-back-to-probability" class="nav-link" data-scroll-target="#from-log-odds-back-to-probability"><span class="header-section-number">8.3.2</span> From Log-Odds Back to Probability</a></li>
  <li><a href="#the-logistic-function-and-its-shape" id="toc-the-logistic-function-and-its-shape" class="nav-link" data-scroll-target="#the-logistic-function-and-its-shape"><span class="header-section-number">8.3.3</span> The Logistic Function and Its Shape</a></li>
  </ul>
</li>
  <li>
<a href="#case-study-understanding-financial-behaviors" id="toc-case-study-understanding-financial-behaviors" class="nav-link" data-scroll-target="#case-study-understanding-financial-behaviors"><span class="header-section-number">8.4</span> Case Study: Understanding Financial Behaviors</a>
  <ul>
<li><a href="#the-dataset" id="toc-the-dataset" class="nav-link" data-scroll-target="#the-dataset"><span class="header-section-number">8.4.1</span> The Dataset</a></li>
  <li><a href="#the-problem-were-trying-to-solve" id="toc-the-problem-were-trying-to-solve" class="nav-link" data-scroll-target="#the-problem-were-trying-to-solve"><span class="header-section-number">8.4.2</span> The Problem We’re Trying to Solve</a></li>
  <li><a href="#study-design" id="toc-study-design" class="nav-link" data-scroll-target="#study-design"><span class="header-section-number">8.4.3</span> Study Design</a></li>
  <li><a href="#applying-study-design-to-our-case-study" id="toc-applying-study-design-to-our-case-study" class="nav-link" data-scroll-target="#applying-study-design-to-our-case-study"><span class="header-section-number">8.4.4</span> Applying Study Design to Our Case Study</a></li>
  </ul>
</li>
  <li>
<a href="#fitting-the-binary-logistic-regression-model" id="toc-fitting-the-binary-logistic-regression-model" class="nav-link" data-scroll-target="#fitting-the-binary-logistic-regression-model"><span class="header-section-number">8.5</span> Fitting the Binary Logistic Regression Model</a>
  <ul>
<li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification"><span class="header-section-number">8.5.1</span> Model Specification</a></li>
  <li><a href="#fitting-in-r" id="toc-fitting-in-r" class="nav-link" data-scroll-target="#fitting-in-r"><span class="header-section-number">8.5.2</span> Fitting in R</a></li>
  <li><a href="#fitting-in-python" id="toc-fitting-in-python" class="nav-link" data-scroll-target="#fitting-in-python"><span class="header-section-number">8.5.3</span> Fitting in Python</a></li>
  <li><a href="#model-output" id="toc-model-output" class="nav-link" data-scroll-target="#model-output"><span class="header-section-number">8.5.4</span> Model Output</a></li>
  </ul>
</li>
  <li><a href="#fitting-the-logistic-regression-model" id="toc-fitting-the-logistic-regression-model" class="nav-link" data-scroll-target="#fitting-the-logistic-regression-model"><span class="header-section-number">8.6</span> Fitting the Logistic Regression Model</a></li>
  <li><a href="#from-logodds-to-probabilities" id="toc-from-logodds-to-probabilities" class="nav-link" data-scroll-target="#from-logodds-to-probabilities"><span class="header-section-number">8.7</span> From Log‑Odds to Probabilities</a></li>
  <li>
<a href="#data-collection-and-wrangling" id="toc-data-collection-and-wrangling" class="nav-link" data-scroll-target="#data-collection-and-wrangling"><span class="header-section-number">8.8</span> Data Collection and Wrangling</a>
  <ul>
<li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection"><span class="header-section-number">8.8.1</span> Data Collection</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="header-section-number">8.8.2</span> Data Wrangling</a></li>
  </ul>
</li>
  <li>
<a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda"><span class="header-section-number">8.9</span> Exploratory Data Analysis (EDA)</a>
  <ul>
<li><a href="#classifying-variables" id="toc-classifying-variables" class="nav-link" data-scroll-target="#classifying-variables"><span class="header-section-number">8.9.1</span> Classifying Variables</a></li>
  <li><a href="#visualizing-distributions" id="toc-visualizing-distributions" class="nav-link" data-scroll-target="#visualizing-distributions"><span class="header-section-number">8.9.2</span> Visualizing Distributions</a></li>
  <li><a href="#exploring-relationships-with-binary-outcome" id="toc-exploring-relationships-with-binary-outcome" class="nav-link" data-scroll-target="#exploring-relationships-with-binary-outcome"><span class="header-section-number">8.9.3</span> Exploring Relationships with Binary Outcome</a></li>
  </ul>
</li>
  <li>
<a href="#data-modelling" id="toc-data-modelling" class="nav-link" data-scroll-target="#data-modelling"><span class="header-section-number">8.10</span> Data Modelling</a>
  <ul>
<li><a href="#choosing-a-logistic-regression-model" id="toc-choosing-a-logistic-regression-model" class="nav-link" data-scroll-target="#choosing-a-logistic-regression-model"><span class="header-section-number">8.10.1</span> Choosing a Logistic Regression Model</a></li>
  <li><a href="#defining-modeling-parameters" id="toc-defining-modeling-parameters" class="nav-link" data-scroll-target="#defining-modeling-parameters"><span class="header-section-number">8.10.2</span> Defining Modeling Parameters</a></li>
  <li><a href="#setting-up-the-logistic-regression-equation" id="toc-setting-up-the-logistic-regression-equation" class="nav-link" data-scroll-target="#setting-up-the-logistic-regression-equation"><span class="header-section-number">8.10.3</span> Setting Up the Logistic Regression Equation</a></li>
  </ul>
</li>
  <li>
<a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation"><span class="header-section-number">8.11</span> Estimation</a>
  <ul>
<li><a href="#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation" class="nav-link" data-scroll-target="#maximum-likelihood-estimation"><span class="header-section-number">8.11.1</span> Maximum Likelihood Estimation</a></li>
  <li><a href="#fitting-the-model-in-practice" id="toc-fitting-the-model-in-practice" class="nav-link" data-scroll-target="#fitting-the-model-in-practice"><span class="header-section-number">8.11.2</span> Fitting the Model in Practice</a></li>
  </ul>
</li>
  <li>
<a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference"><span class="header-section-number">8.12</span> Inference</a>
  <ul>
<li><a href="#wald-tests" id="toc-wald-tests" class="nav-link" data-scroll-target="#wald-tests"><span class="header-section-number">8.12.1</span> Wald Tests</a></li>
  <li><a href="#likelihood-ratio-tests" id="toc-likelihood-ratio-tests" class="nav-link" data-scroll-target="#likelihood-ratio-tests"><span class="header-section-number">8.12.2</span> Likelihood Ratio Tests</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">8.12.3</span> Confidence Intervals</a></li>
  </ul>
</li>
  <li>
<a href="#coefficient-interpretation" id="toc-coefficient-interpretation" class="nav-link" data-scroll-target="#coefficient-interpretation"><span class="header-section-number">8.13</span> Coefficient Interpretation</a>
  <ul>
<li><a href="#odds-ratios-and-their-meaning" id="toc-odds-ratios-and-their-meaning" class="nav-link" data-scroll-target="#odds-ratios-and-their-meaning"><span class="header-section-number">8.13.1</span> Odds Ratios and Their Meaning</a></li>
  <li><a href="#pitfalls-in-interpretation" id="toc-pitfalls-in-interpretation" class="nav-link" data-scroll-target="#pitfalls-in-interpretation"><span class="header-section-number">8.13.2</span> Pitfalls in Interpretation</a></li>
  <li><a href="#example-from-loan-default-dataset" id="toc-example-from-loan-default-dataset" class="nav-link" data-scroll-target="#example-from-loan-default-dataset"><span class="header-section-number">8.13.3</span> Example from Loan Default Dataset</a></li>
  </ul>
</li>
  <li>
<a href="#predictions" id="toc-predictions" class="nav-link" data-scroll-target="#predictions"><span class="header-section-number">8.14</span> Predictions</a>
  <ul>
<li><a href="#predicted-probabilities-vs.-predicted-classes" id="toc-predicted-probabilities-vs.-predicted-classes" class="nav-link" data-scroll-target="#predicted-probabilities-vs.-predicted-classes"><span class="header-section-number">8.14.1</span> Predicted Probabilities vs.&nbsp;Predicted Classes</a></li>
  <li><a href="#evaluating-performance" id="toc-evaluating-performance" class="nav-link" data-scroll-target="#evaluating-performance"><span class="header-section-number">8.14.2</span> Evaluating Performance</a></li>
  </ul>
</li>
  <li>
<a href="#goodness-of-fit-model-selection" id="toc-goodness-of-fit-model-selection" class="nav-link" data-scroll-target="#goodness-of-fit-model-selection"><span class="header-section-number">8.15</span> Goodness of Fit &amp; Model Selection</a>
  <ul>
<li><a href="#pseudo-r-squared-measures" id="toc-pseudo-r-squared-measures" class="nav-link" data-scroll-target="#pseudo-r-squared-measures"><span class="header-section-number">8.15.1</span> Pseudo R-Squared Measures</a></li>
  <li><a href="#analysis-of-deviance" id="toc-analysis-of-deviance" class="nav-link" data-scroll-target="#analysis-of-deviance"><span class="header-section-number">8.15.2</span> Analysis of Deviance</a></li>
  <li><a href="#information-criteria" id="toc-information-criteria" class="nav-link" data-scroll-target="#information-criteria"><span class="header-section-number">8.15.3</span> Information Criteria</a></li>
  </ul>
</li>
  <li>
<a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics"><span class="header-section-number">8.16</span> Model Diagnostics</a>
  <ul>
<li><a href="#deviance-residuals" id="toc-deviance-residuals" class="nav-link" data-scroll-target="#deviance-residuals"><span class="header-section-number">8.16.1</span> Deviance Residuals</a></li>
  <li><a href="#binned-residual-plots" id="toc-binned-residual-plots" class="nav-link" data-scroll-target="#binned-residual-plots"><span class="header-section-number">8.16.2</span> Binned Residual Plots</a></li>
  <li><a href="#detecting-influential-points" id="toc-detecting-influential-points" class="nav-link" data-scroll-target="#detecting-influential-points"><span class="header-section-number">8.16.3</span> Detecting Influential Points</a></li>
  </ul>
</li>
  <li>
<a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">8.17</span> Results</a>
  <ul>
<li><a href="#predictive-analysis" id="toc-predictive-analysis" class="nav-link" data-scroll-target="#predictive-analysis"><span class="header-section-number">8.17.1</span> Predictive Analysis</a></li>
  <li><a href="#inferential-analysis" id="toc-inferential-analysis" class="nav-link" data-scroll-target="#inferential-analysis"><span class="header-section-number">8.17.2</span> Inferential Analysis</a></li>
  </ul>
</li>
  <li><a href="#storytelling" id="toc-storytelling" class="nav-link" data-scroll-target="#storytelling"><span class="header-section-number">8.18</span> Storytelling</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/alexrod61/regression-cookbook/edit/main/book/08-binary-logistic.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/alexrod61/regression-cookbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/alexrod61/regression-cookbook/blob/main/book/08-binary-logistic.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/discrete-zone.html">Discrete Cuisine</a></li><li class="breadcrumb-item"><a href="../book/08-binary-logistic.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binary Logistic Regression</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">Binary Logistic Regression</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!--#
# Quarto Document Setup
# ======================================================
# This section defines metadata and execution rules for the chapter.
# - "title" sets the chapter title displayed in the rendered book.
# - "execute: eval: false" prevents R/Python code from being run 
#   during rendering (useful if code is illustrative, or if setup 
#   is handled separately).
# ====================================================== --><!-- ======================================================
Google Analytics Tracking Snippet
------------------------------------------------------
- This loads the Google Analytics "gtag.js" script asynchronously 
  so it does not block page rendering.
- The `id` value ("G-7PRVEBE1EF") is your unique measurement ID.
- `window.dataLayer` is initialized if it doesn’t exist already.
- The `gtag` function pushes tracking events into the dataLayer.
- `gtag('js', new Date());` records the time the analytics script 
  was loaded.
- `gtag('config', 'G-7PRVEBE1EF');` activates tracking for this ID.
------------------------------------------------------
You can safely move this block into the YAML `include-in-header` 
if you want it injected site-wide, rather than repeating it per 
chapter.
====================================================== --><!-- Google tag (gtag.js) --><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-7PRVEBE1EF"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7PRVEBE1EF');
</script><!-- 
This block creates a **Mermaid mindmap diagram** that shows how different 
chapters in the book fit into the broader context of regression analysis.  

- It organizes regression models by the type of outcome variable (Continuous vs. Discrete).  
- Each branch links to a chapter in the book (e.g., OLS, Gamma Regression, Beta Regression).  
- This diagram provides readers with a "map" of where Binary Logistic Regression fits in.  
--><div id="fig-binary-logistic-regression" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-binary-logistic-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>

</div>
<p></p>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-binary-logistic-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1
</figcaption></figure>
</div>
<div class="LO">
<div class="LO-header">
<p><strong>Learning Objectives</strong></p>
</div>
<div class="LO-container">
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Explain how <strong>Binary Logistic Regression</strong> models the probability of a binary outcome using <strong>log-odds</strong>.<br>
</li>
<li>Describe why <strong>Ordinary Least Squares</strong> is not appropriate for binary outcomes, and how the <strong>logistic function</strong> addresses this.<br>
</li>
<li>Fit a binary logistic regression model in both <code>R</code> and <code>Python</code>.<br>
</li>
<li>Interpret <strong>log-odds</strong>, <strong>odds ratios</strong>, and <strong>predicted probabilities</strong> in real-world contexts.<br>
</li>
<li>Evaluate model fit using metrics such as <strong>accuracy</strong>, <strong>confusion matrices</strong>, and <strong>ROC curves</strong>.<br>
</li>
<li>Identify when binary logistic regression is the <strong>appropriate tool</strong>, and understand its <strong>limitations</strong>.<br>
</li>
</ul>
</div>
</div>
<section id="introduction" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">8.1</span> Introduction</h2>
<p>In many real-world problems, the outcome we’re trying to predict is <strong>not a number</strong> — it’s a <strong>yes or no</strong>, <strong>success or failure</strong>, <strong>clicked or didn’t click</strong>. For example:</p>
<ul>
<li>Will a student <strong>default on a loan</strong> given their credit score and income?</li>
<li>Will a student <strong>pass a course</strong> based on whether they have a part-time job and how many hours they studied?</li>
<li>Will a student <strong>likely graduate within 4 years</strong>, based on their academic record and declared major?</li>
</ul>
<p>These outcomes are <strong>binary</strong>: they can take on only two possible values, typically coded as <code>1</code> (event occurs) and <code>0</code> (event does not occur).</p>
<p>To model such outcomes, we need a regression approach that produces <strong>predicted probabilities</strong> between 0 and 1 — not arbitrary numbers on the real line. This is where <strong>Binary Logistic Regression</strong> comes in.</p>
<p>In this chapter, we’ll see how logistic regression: - Links input variables to the <strong>log-odds</strong> of the outcome, - Produces interpretable coefficients (like <strong>odds ratios</strong>), and - Helps us make informed predictions in binary classification problems.</p>
</section><section id="why-ordinary-least-squares-fails-for-binary-outcomes" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="why-ordinary-least-squares-fails-for-binary-outcomes">
<span class="header-section-number">8.2</span> Why Ordinary Least Squares Fails for Binary Outcomes</h2>
<p>To understand the need for logistic regression, consider applying Ordinary Least Squares (OLS) to a <strong>binary outcome</strong>.</p>
<p>Suppose we are trying to predict whether a student <strong>defaulted</strong> on a loan (<code>1</code>) or <strong>did not default</strong> (<code>0</code>) using a continuous predictor like <code>credit_score</code>.</p>
<p>Before diving into the technical reasons why OLS is inappropriate for binary outcomes, let’s look at a simplified version of the dataset we’ll use throughout this chapter:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Prepare data: numeric default variable and select predictor</span></span>
<span><span class="va">blr_data</span> <span class="op">&lt;-</span> <span class="va">BLR</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">credit_score</span>, <span class="va">defaulted</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>defaulted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">defaulted</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Below is a sample of this dataset:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;"><strong>credit_score</strong></th>
<th style="text-align: right;"><strong>income</strong></th>
<th style="text-align: right;"><strong>education_years</strong></th>
<th style="text-align: right;"><strong>married</strong></th>
<th style="text-align: right;"><strong>owns_home</strong></th>
<th style="text-align: right;"><strong>age</strong></th>
<th style="text-align: right;"><strong>defaulted</strong></th>
<th style="text-align: right;"><strong>successes</strong></th>
<th style="text-align: right;"><strong>trials</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">787</td>
<td style="text-align: right;">118911</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">441</td>
<td style="text-align: right;">53122</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">407</td>
<td style="text-align: right;">39174</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">812</td>
<td style="text-align: right;">148982</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">825</td>
<td style="text-align: right;">154293</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">729</td>
<td style="text-align: right;">111562</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">700</td>
<td style="text-align: right;">70000</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">451</td>
<td style="text-align: right;">40311</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">404</td>
<td style="text-align: right;">45944</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">374</td>
<td style="text-align: right;">43167</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
<p>Now, let’s narrow in on the key variables of interest for this section.</p>
<table class="caption-top table">
<thead><tr class="header">
<th><strong>credit_score</strong></th>
<th><strong>defaulted</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>787</td>
<td>0</td>
</tr>
<tr class="even">
<td>441</td>
<td>1</td>
</tr>
<tr class="odd">
<td>407</td>
<td>1</td>
</tr>
<tr class="even">
<td>812</td>
<td>0</td>
</tr>
<tr class="odd">
<td>825</td>
<td>0</td>
</tr>
<tr class="even">
<td>729</td>
<td>0</td>
</tr>
<tr class="odd">
<td>700</td>
<td>0</td>
</tr>
<tr class="even">
<td>451</td>
<td>1</td>
</tr>
<tr class="odd">
<td>404</td>
<td>1</td>
</tr>
<tr class="even">
<td>374</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>This dataset allows us to examine whether a student defaulted on a loan (<code>defaulted = 1</code>) based on their <code>credit_score</code>. It’s a classic binary outcome: a “yes” or “no” event.</p>
<p>If we use OLS, we estimate:</p>
<p><span class="math display">\[
\mathbb{E}(Y_i \mid X_i) = p_i = \beta_0 + \beta_1 X_i
\]</span></p>
<p>This means we’re treating the <strong>probability of default</strong> as a linear function of credit score.</p>
<p>However, there are <strong>two fundamental issues</strong> with using OLS here:</p>
<ol type="1">
<li>The linear model can produce predicted values <strong>less than 0</strong> or <strong>greater than 1</strong> — which doesn’t make sense when modeling a <strong>probability</strong>.</li>
<li>OLS assumes <strong>constant variance</strong> of the residuals, but binary outcomes inherently violate this assumption, because their variance depends on the mean:</li>
</ol>
<p><span class="math display">\[
\text{Var}(Y_i) = p_i(1 - p_i)
\]</span></p>
<p>To see this issue in action, let’s try fitting an OLS regression model using our binary outcome and a continuous predictor. While OLS is designed to minimize squared error, it doesn’t account for the discrete nature of the response — which means it can return predicted probabilities below 0 or above 1. In the example below, we use a customer’s credit score to predict the probability of default, and you’ll see how the linear model fails to respect the fundamental constraints of probability.</p>
<div id="fig-ols-failure-binary" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ols-failure-binary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/ols-failure-credit-score2.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ols-failure-binary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.2: OLS fails to constrain predictions between 0 and 1, despite binary outcomes.
</figcaption></figure>
</div>
<p>These limitations make OLS unsuitable for binary classification tasks.<br>
To properly model binary outcomes, we need a method that:</p>
<ul>
<li>Produces predictions strictly between 0 and 1,</li>
<li>Accounts for the fact that the variance depends on the mean, and</li>
<li>Connects our predictors to the probability of the event in a way that is easy to interpret.</li>
</ul>
<p>The key idea is to <strong>transform the probability</strong> so that it can be modeled as a linear function without breaking these rules.<br>
In the next section, we’ll see how the <strong>logit transformation</strong> does exactly that.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ⚠️ This OLS fit is not appropriate for binary outcomes.</span></span>
<span><span class="co"># We include it here only to illustrate why logistic regression is needed.</span></span>
<span></span>
<span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare data: numeric default variable and select predictor</span></span>
<span><span class="va">blr_data</span> <span class="op">&lt;-</span> <span class="va">BLR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">credit_score</span>, <span class="va">defaulted</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>defaulted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">defaulted</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit an OLS model (not ideal for binary outcome)</span></span>
<span><span class="va">ols_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span>, data <span class="op">=</span> <span class="va">blr_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add predicted values</span></span>
<span><span class="va">blr_data</span><span class="op">$</span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ols_model</span>, newdata <span class="op">=</span> <span class="va">blr_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot actual data and OLS-fitted line</span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">blr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">credit_score</span>, y <span class="op">=</span> <span class="va">defaulted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.05</span>, width <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"OLS Fitted Line on Binary Data"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Credit Score"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Predicted Probability of Default"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ⚠️ This OLS fit is not appropriate for binary outcomes.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We include it here only to illustrate why logistic regression is needed.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract relevant columns from the BLR dataset</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>blr <span class="op">=</span> r.data[<span class="st">'BLR'</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> blr[[<span class="st">'credit_score'</span>, <span class="st">'defaulted'</span>]].copy()</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit an OLS model</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(df[<span class="st">'credit_score'</span>])</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.OLS(df[<span class="st">'defaulted'</span>], X).fit()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'predicted'</span>] <span class="op">=</span> model.predict(X)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the actual binary outcomes and OLS predictions</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>ax.scatter(df[<span class="st">'credit_score'</span>], df[<span class="st">'defaulted'</span>], alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">'black'</span>, label<span class="op">=</span><span class="st">'Actual Data'</span>, s<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>ax.plot(df[<span class="st">'credit_score'</span>], df[<span class="st">'predicted'</span>], color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'OLS Fit'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"OLS Fitted Line on Binary Data"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Credit Score"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Predicted Probability of Default"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R Output TODO</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python Output TODO</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">

</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">

</div>
</div>
</div>
</section><section id="the-logit-function" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="the-logit-function">
<span class="header-section-number">8.3</span> The Logit Function</h2>
<p>In Section 8.2, we saw that modeling probability directly with a linear equation can produce impossible values (less than 0 or greater than 1) and ignores the way variance changes with the mean.</p>
<p>The fix is to apply a transformation that:</p>
<ul>
<li>Expands the (0, 1) probability range to the entire real line,</li>
<li>Is reversible, so we can convert back to probabilities, and</li>
<li>Preserves the ordering of probabilities.</li>
</ul>
<p>One transformation that checks all these boxes is the <strong>logit function</strong>.</p>
<section id="logit-a-link-between-probability-and-linear-predictors" class="level3" data-number="8.3.1"><h3 data-number="8.3.1" class="anchored" data-anchor-id="logit-a-link-between-probability-and-linear-predictors">
<span class="header-section-number">8.3.1</span> Logit: A Link Between Probability and Linear Predictors</h3>
<p>The <strong>logit function</strong> transforms the probability <span class="math inline">\(p_i\)</span> into a value on the entire real line: <span class="math display">\[
\text{logit}(p_i) = \log\!\left(\frac{p_i}{1 - p_i}\right) = \beta_0 + \beta_1 X_i
\]</span></p>
<p>This transformation:</p>
<ul>
<li>Is <strong>monotonic</strong> (it preserves order),</li>
<li>Maps probabilities <span class="math inline">\(p_i \in (0, 1)\)</span> to <span class="math inline">\((-\infty, \infty)\)</span>, and</li>
<li>Solves the range issue of OLS by letting us fit a linear model in the transformed space.</li>
</ul>
<p>By modeling the <strong>log-odds</strong> as a linear function of predictors and then inverting the transformation, we obtain valid predicted <strong>probabilities</strong> that remain within <span class="math inline">\([0,1]\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <strong>logit function</strong> is defined as: <span class="math display">\[
\text{logit}(p_i) = \log\!\left(\frac{p_i}{1 - p_i}\right)
\]</span> It models the <strong>log-odds</strong> of the outcome as a linear function of predictors.</p>
</div>
</div>
</section><section id="from-log-odds-back-to-probability" class="level3" data-number="8.3.2"><h3 data-number="8.3.2" class="anchored" data-anchor-id="from-log-odds-back-to-probability">
<span class="header-section-number">8.3.2</span> From Log-Odds Back to Probability</h3>
<p>We can invert the logit function to get predicted probabilities: <span class="math display">\[
p_i = \frac{\exp\!\left(\beta_0 + \beta_1 X_i\right)}{1 + \exp\!\left(\beta_0 + \beta_1 X_i\right)} \in (0,1)
\]</span></p>
<p>This <strong>sigmoid function</strong> outputs values strictly between 0 and 1 for any real-valued linear predictor, making it ideal for modeling probabilities.</p>
<p>This transformation lets us use a linear predictor on the <strong>log-odds</strong> scale and then recover valid probabilities.<br>
This idea forms the basis of <strong>binary logistic regression</strong>, introduced next.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TODO:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add an annotated diagram showing how increasing <code>X</code> impacts odds, log-odds, and probabilities.</p>
</div>
</div>
<hr></section><section id="the-logistic-function-and-its-shape" class="level3" data-number="8.3.3"><h3 data-number="8.3.3" class="anchored" data-anchor-id="the-logistic-function-and-its-shape">
<span class="header-section-number">8.3.3</span> The Logistic Function and Its Shape</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#| fig-cap: "The logistic (sigmoid) curve maps any real-valued linear predictor to probabilities in [0,1]. A linear fit can wander outside [0,1]."</span></span>
<span><span class="co">#| fig-width: 7</span></span>
<span><span class="co">#| fig-height: 4</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1.2</span> <span class="op">*</span> <span class="va">x</span>                    <span class="co"># linear predictor</span></span>
<span><span class="va">p</span>   <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span>             <span class="co"># sigmoid</span></span>
<span></span>
<span><span class="co"># A naive linear "probability" for comparison (clipped display range only)</span></span>
<span><span class="va">p_lin</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html">rescale</a></span><span class="op">(</span><span class="va">eta</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, sigmoid <span class="op">=</span> <span class="va">p</span>, linear <span class="op">=</span> <span class="va">p_lin</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">sigmoid</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">linear</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Linear predictor  (η = β0 + β1 X)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mapped value"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Solid: logistic (valid probabilities).  Dashed: naive linear (can leave [0,1])."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Introduce the <strong>sigmoid</strong> function:</li>
</ul>
<p><span class="math display">\[
p_i = \frac{1}{1 + e^{-(\beta_0 + \beta_1 X_i)}}
\]</span></p>
<ul>
<li>It maps real-valued input to the [0, 1] interval.</li>
<li>Shape: S-curve — slow rise at ends, steep middle.</li>
<li>Contrast visually with a linear line from OLS.</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Logistic vs Linear fit demo</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1.2</span> <span class="op">*</span> <span class="va">x</span></span>
<span><span class="va">p</span>   <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span>   <span class="co"># logistic sigmoid</span></span>
<span></span>
<span><span class="co"># Linear "probability" rescaled to [−0.4, 1.4] just for comparison</span></span>
<span><span class="va">p_lin</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/rescale.html">rescale</a></span><span class="op">(</span><span class="va">eta</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>, <span class="fl">1.4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, sigmoid <span class="op">=</span> <span class="va">p</span>, linear <span class="op">=</span> <span class="va">p_lin</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">sigmoid</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">linear</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Linear predictor  (η = β0 + β1 X)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mapped value"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Blue: logistic sigmoid (valid probabilities).  Red dashed: naive linear fit (can leave [0,1])."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">200</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> <span class="op">-</span><span class="dv">1</span> <span class="op">+</span> <span class="fl">1.2</span> <span class="op">*</span> x</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>eta))  <span class="co"># logistic sigmoid</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear "probability" rescaled</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>p_lin <span class="op">=</span> (eta <span class="op">-</span> eta.<span class="bu">min</span>()) <span class="op">/</span> (eta.<span class="bu">max</span>() <span class="op">-</span> eta.<span class="bu">min</span>()) <span class="op">*</span> (<span class="fl">1.4</span> <span class="op">-</span> (<span class="op">-</span><span class="fl">0.4</span>)) <span class="op">+</span> (<span class="op">-</span><span class="fl">0.4</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">4</span>))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p, label<span class="op">=</span><span class="st">"Logistic sigmoid"</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">"blue"</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.plot(x, p_lin, <span class="st">"--"</span>, label<span class="op">=</span><span class="st">"Naive linear fit"</span>, color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Linear predictor  (η = β0 + β1 X)"</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Mapped value"</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Logistic curve vs. linear fit"</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr></section></section><section id="case-study-understanding-financial-behaviors" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="case-study-understanding-financial-behaviors">
<span class="header-section-number">8.4</span> Case Study: Understanding Financial Behaviors</h2>
<p>Statistical models are most useful when they connect to a real-world problem. Here, we’ll use binary logistic regression to study <strong>financial behavior</strong> — specifically, the likelihood that a student <strong>defaults</strong> on a loan.</p>
<hr>
<section id="the-dataset" class="level3" data-number="8.4.1"><h3 data-number="8.4.1" class="anchored" data-anchor-id="the-dataset">
<span class="header-section-number">8.4.1</span> The Dataset</h3>
<p>We’ll use the <code>Logistic_Regression</code> dataset (packaged in <code>cookbook</code>).</p>
<ul>
<li>
<p><strong>Predictors</strong>:</p>
<ul>
<li>
<code>credit_score</code> (numeric, higher = lower risk)</li>
<li>
<code>income</code> (numeric, annual income in dollars)</li>
<li>
<code>age</code> (numeric)</li>
<li>
<code>loan_amount</code> (numeric, loan size)</li>
<li>
<code>student</code> (categorical: yes/no)</li>
</ul>
</li>
<li>
<p><strong>Outcome</strong>:</p>
<ul>
<li>
<code>defaulted</code> (binary: <code>1 = default</code>, <code>0 = no default</code>)</li>
</ul>
</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is a <strong>binary classification problem</strong>: given a mix of continuous and categorical predictors, we want to predict whether a student defaults.</p>
</div>
</div>
<hr></section><section id="the-problem-were-trying-to-solve" class="level3" data-number="8.4.2"><h3 data-number="8.4.2" class="anchored" data-anchor-id="the-problem-were-trying-to-solve">
<span class="header-section-number">8.4.2</span> The Problem We’re Trying to Solve</h3>
<p>Banks and lenders routinely face the question:</p>
<blockquote class="blockquote">
<p><em>Given a customer’s information, what is the probability that they will default on a loan?</em></p>
</blockquote>
<p>Why it matters:</p>
<ul>
<li>Accurate predictions reduce <strong>financial risk</strong>.</li>
<li>Misclassification can be costly (approving high-risk loans or rejecting low-risk ones).</li>
<li>Logistic regression provides both <strong>probability estimates</strong> and interpretable <strong>odds ratios</strong> for each predictor.</li>
</ul>
<hr></section><section id="study-design" class="level3" data-number="8.4.3"><h3 data-number="8.4.3" class="anchored" data-anchor-id="study-design">
<span class="header-section-number">8.4.3</span> Study Design</h3>
<ul>
<li><p><strong>Predictor types</strong>: both <strong>continuous</strong> (income, age, credit_score, loan_amount) and <strong>categorical</strong> (student status).</p></li>
<li><p><strong>Outcome</strong>: binary (defaulted).</p></li>
<li><p><strong>Sample size</strong>: dataset includes a few hundred observations (enough to illustrate the method).</p></li>
<li>
<p><strong>Assumptions</strong>:</p>
<ul>
<li>Observations are independent.</li>
<li>Predictors have a linear relationship with the <strong>log-odds</strong> of default.</li>
<li>No perfect collinearity among predictors.</li>
</ul>
</li>
</ul>
<hr></section><section id="applying-study-design-to-our-case-study" class="level3" data-number="8.4.4"><h3 data-number="8.4.4" class="anchored" data-anchor-id="applying-study-design-to-our-case-study">
<span class="header-section-number">8.4.4</span> Applying Study Design to Our Case Study</h3>
<p>Before modeling, we:</p>
<ul>
<li>
<strong>Split data</strong> into training and testing sets.</li>
<li>
<strong>Encode categorical variables</strong> (e.g., <code>student</code> → 0/1).</li>
<li>
<strong>Standardize or rescale predictors</strong> if needed for interpretation.</li>
<li>
<strong>Preview</strong> the structure of the data:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Peek at dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python equivalent</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(py$data).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the dataset understood and prepared, we’re ready to fit a <strong>binary logistic regression model</strong> to predict loan default.</p>
<hr></section></section><section id="fitting-the-binary-logistic-regression-model" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="fitting-the-binary-logistic-regression-model">
<span class="header-section-number">8.5</span> Fitting the Binary Logistic Regression Model</h2>
<p>Now that we’ve introduced the dataset and design, we can fit a <strong>binary logistic regression model</strong>. Our goal is to estimate how predictors like <code>credit_score</code>, <code>income</code>, and <code>student</code> status influence the likelihood of <strong>default</strong>.</p>
<hr>
<section id="model-specification" class="level3" data-number="8.5.1"><h3 data-number="8.5.1" class="anchored" data-anchor-id="model-specification">
<span class="header-section-number">8.5.1</span> Model Specification</h3>
<p>The model assumes:</p>
<p><span class="math display">\[
\begin{aligned}
\text{logit}(p_i) &amp;= \log\!\left(\frac{p_i}{1 - p_i}\right) \\
&amp;= \beta_0
  + \beta_1\,\text{credit\_score}_i
  + \beta_2\,\text{income}_i \\
&amp;\quad + \beta_3\,\text{age}_i
  + \beta_4\,\text{loan\_amount}_i
  + \beta_5\,\text{student}_i
\end{aligned}
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(p\_i =\)</span> probability of default for customer <span class="math inline">\(i\)</span>
</li>
<li>
<span class="math inline">\(\beta\_j =\)</span> regression coefficients</li>
</ul>
<hr></section><section id="fitting-in-r" class="level3" data-number="8.5.2"><h3 data-number="8.5.2" class="anchored" data-anchor-id="fitting-in-r">
<span class="header-section-number">8.5.2</span> Fitting in R</h3>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fit logistic regression model</span></span>
<span><span class="va">fit_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">loan_amount</span> <span class="op">+</span> <span class="va">student</span>,</span>
<span>             data <span class="op">=</span> <span class="va">BLR</span>,</span>
<span>             family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_r</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section><section id="fitting-in-python" class="level3" data-number="8.5.3"><h3 data-number="8.5.3" class="anchored" data-anchor-id="fitting-in-python">
<span class="header-section-number">8.5.3</span> Fitting in Python</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define predictors (X) and outcome (y)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> py$data[[<span class="st">'credit_score'</span>, <span class="st">'income'</span>, <span class="st">'age'</span>, <span class="st">'loan_amount'</span>, <span class="st">'student'</span>]]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)  <span class="co"># add intercept</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> py$data[<span class="st">'defaulted'</span>]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit logistic regression</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> sm.Logit(y, X).fit()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr></section><section id="model-output" class="level3" data-number="8.5.4"><h3 data-number="8.5.4" class="anchored" data-anchor-id="model-output">
<span class="header-section-number">8.5.4</span> Model Output</h3>
<ul>
<li>Each coefficient (<span class="math inline">\(\beta\_j\)</span>) is expressed on the <strong>log-odds scale</strong>.</li>
<li>Positive coefficients → higher log-odds of default (greater risk).</li>
<li>Negative coefficients → lower log-odds of default (less risk).</li>
</ul>
<p>We will later translate these log-odds into <strong>odds ratios</strong> and <strong>predicted probabilities</strong> for interpretation.</p>
<hr></section></section><section id="fitting-the-logistic-regression-model" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="fitting-the-logistic-regression-model">
<span class="header-section-number">8.6</span> Fitting the Logistic Regression Model</h2>
<p>We model the <strong>log‑odds</strong> of default as a linear function of predictors. In practice:</p>
<ul>
<li>
<strong>R:</strong> <code>glm(..., family = binomial(link = "logit"))</code>
</li>
<li>
<strong>Python:</strong> <code>statsmodels.Logit(...)</code>
</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fit a simple, interpretable model</span></span>
<span><span class="va">fit_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span></span>
<span>  <span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>  data <span class="op">=</span> <span class="va">BLR</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coefficients (log-odds) and odds ratios</span></span>
<span><span class="va">coef_table</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fit_glm</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">coef_table</span><span class="op">$</span><span class="va">odds_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">coef_table</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></span>
<span><span class="va">coef_table</span><span class="op">$</span><span class="va">or_low</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">coef_table</span><span class="op">$</span><span class="va">conf.low</span><span class="op">)</span></span>
<span><span class="va">coef_table</span><span class="op">$</span><span class="va">or_high</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">coef_table</span><span class="op">$</span><span class="va">conf.high</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">coef_table</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"term"</span>,<span class="st">"estimate"</span>,<span class="st">"std.error"</span>,<span class="st">"statistic"</span>,<span class="st">"p.value"</span>,<span class="st">"odds_ratio"</span>,<span class="st">"or_low"</span>,<span class="st">"or_high"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Term"</span>,<span class="st">"Log-Odds (β)"</span>,<span class="st">"SE"</span>,<span class="st">"z"</span>,<span class="st">"p"</span>,<span class="st">"Odds Ratio"</span>,<span class="st">"OR 2.5%"</span>,<span class="st">"OR 97.5%"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># BLR was exported from R in the setup; use it directly</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> BLR.copy()</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y, X).fit(disp<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a coefficient table with odds ratios and CIs</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> logit_model.params</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>bse    <span class="op">=</span> logit_model.bse</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>zvals  <span class="op">=</span> params <span class="op">/</span> bse</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>pvals  <span class="op">=</span> logit_model.pvalues</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>conf   <span class="op">=</span> logit_model.conf_int()</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>or_    <span class="op">=</span> np.exp(params)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>or_lo  <span class="op">=</span> np.exp(conf[<span class="dv">0</span>])</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>or_hi  <span class="op">=</span> np.exp(conf[<span class="dv">1</span>])</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>coef_table <span class="op">=</span> pd.DataFrame({</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Term"</span>: params.index,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Log-Odds (β)"</span>: params.values,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SE"</span>: bse.values,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"z"</span>: zvals.values,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"p"</span>: pvals.values,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Odds Ratio"</span>: or_.values,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"OR 2.5%"</span>: or_lo.values,</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"OR 97.5%"</span>: or_hi.values</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>coef_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><strong>Notes</strong></p>
<ul>
<li>Coefficients are in <strong>log‑odds</strong> units.</li>
<li>Exponentiating a coefficient gives the <strong>odds ratio</strong>: <span class="math inline">\(\text{OR} = e^{\beta}\)</span>.</li>
<li>E.g., <span class="math inline">\(\beta_{\text{credit\_score}}=-0.01\Rightarrow \text{OR}\approx 0.99\)</span>: each 1‑point increase in credit score multiplies the odds of default by ~0.99 (≈1% decrease).</li>
</ul>
<hr></section><section id="from-logodds-to-probabilities" class="level2" data-number="8.7"><h2 data-number="8.7" class="anchored" data-anchor-id="from-logodds-to-probabilities">
<span class="header-section-number">8.7</span> From Log‑Odds to Probabilities</h2>
<p>The inverse‑logit (a.k.a. logistic/sigmoid) maps any linear predictor <span class="math inline">\(\eta\)</span> back to a valid probability:</p>
<p><span class="math display">\[
p = \text{logit}^{-1}(\eta) = \frac{1}{1 + e^{-\eta}}
\]</span></p>
<p>Below we:</p>
<ol type="1">
<li>get <strong>linear predictors</strong> (<span class="math inline">\(\eta\)</span>),</li>
<li>transform to <strong>probabilities</strong> <span class="math inline">\(p\)</span>, and</li>
<li>compute example probabilities at low/median/high credit scores (holding income at its mean).</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1) Linear predictor (η) and probability (p) for observed rows</span></span>
<span><span class="va">BLR</span><span class="op">$</span><span class="va">eta_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_glm</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span>         <span class="co"># η = Xβ</span></span>
<span><span class="va">BLR</span><span class="op">$</span><span class="va">p_hat</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_glm</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>     <span class="co"># p = logistic(η)</span></span>
<span></span>
<span><span class="co"># 2) Example scenarios at low / median / high credit score</span></span>
<span><span class="va">qs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">credit_score</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">newdat</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  credit_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">qs</span><span class="op">)</span>,</span>
<span>  income <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">income</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low (25th %)"</span>,<span class="st">"Median (50th %)"</span>,<span class="st">"High (75th %)"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdat</span><span class="op">$</span><span class="va">eta</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_glm</span>, newdata <span class="op">=</span> <span class="va">newdat</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span>
<span><span class="va">newdat</span><span class="op">$</span><span class="va">prob</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_glm</span>, newdata <span class="op">=</span> <span class="va">newdat</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">newdat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"label"</span>,<span class="st">"credit_score"</span>,<span class="st">"income"</span>,<span class="st">"eta"</span>,<span class="st">"prob"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Scenario"</span>,<span class="st">"Credit Score"</span>,<span class="st">"Income (mean)"</span>,<span class="st">"η (linear predictor)"</span>,<span class="st">"Probability"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Linear predictor and probabilities for observed rows</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>eta_hat <span class="op">=</span> np.dot(X, logit_model.params)      <span class="co"># η = Xβ</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>p_hat   <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>eta_hat))         <span class="co"># logistic(η)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>df_out <span class="op">=</span> df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>,<span class="st">'defaulted'</span>]].copy()</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>df_out[<span class="st">'eta_hat'</span>] <span class="op">=</span> eta_hat</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>df_out[<span class="st">'p_hat'</span>]   <span class="op">=</span> p_hat</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Example scenarios at low / median / high credit score (income at mean)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>qs <span class="op">=</span> df[<span class="st">'credit_score'</span>].quantile([<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>]).values</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>inc_mean <span class="op">=</span> df[<span class="st">'income'</span>].mean()</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>newX <span class="op">=</span> pd.DataFrame({</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'const'</span>: <span class="fl">1.0</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'credit_score'</span>: qs,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'income'</span>: [inc_mean, inc_mean, inc_mean]</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>}, index<span class="op">=</span>[<span class="st">"Low (25th %)"</span>,<span class="st">"Median (50th %)"</span>,<span class="st">"High (75th %)"</span>])</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> np.dot(newX, logit_model.params)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>eta))</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Scenario"</span>: newX.index,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Credit Score"</span>: newX[<span class="st">'credit_score'</span>].values,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Income (mean)"</span>: newX[<span class="st">'income'</span>].values,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"η (linear predictor)"</span>: eta,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Probability"</span>: prob</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p><strong>Takeaway</strong></p>
<ul>
<li>The model fits a straight line on the <strong>log‑odds</strong> scale, then the <strong>inverse‑logit</strong> maps it to valid probabilities in <span class="math inline">\([0,1]\)</span>.</li>
<li>You can read coefficients as changes in <strong>log‑odds</strong>, or exponentiate to <strong>odds ratios</strong>; but to <strong>communicate</strong>, show <strong>probabilities</strong> for realistic scenarios (like low/median/high credit score).</li>
</ul>
<hr></section><section id="data-collection-and-wrangling" class="level2" data-number="8.8"><h2 data-number="8.8" class="anchored" data-anchor-id="data-collection-and-wrangling">
<span class="header-section-number">8.8</span> Data Collection and Wrangling</h2>
<p>Before building a logistic regression model, we need to ensure our data is <strong>reliable, clean, and structured</strong> for analysis. Poor data preparation can undermine even the best statistical methods.</p>
<section id="data-collection" class="level3" data-number="8.8.1"><h3 data-number="8.8.1" class="anchored" data-anchor-id="data-collection">
<span class="header-section-number">8.8.1</span> Data Collection</h3>
<p>In our case, we’re working with a <strong>loan default dataset</strong>. Each row represents a borrower, and the key outcome is whether they <strong>defaulted on their loan</strong> (<code>defaulted = 1</code>) or not (<code>defaulted = 0</code>). Predictors include:</p>
<ul>
<li>
<strong>credit_score</strong> (continuous)</li>
<li>
<strong>income</strong> (continuous)</li>
<li>
<strong>education_years</strong> (continuous)</li>
<li>
<strong>married</strong> (binary categorical)</li>
<li>
<strong>owns_home</strong> (binary categorical)</li>
<li>
<strong>age</strong> (continuous)</li>
</ul>
<p>The dataset also contains <code>successes</code> and <code>trials</code> (grouped-binomial form), but in this chapter we’ll treat outcomes as <strong>individual-level Bernoulli trials</strong>.</p>
</section><section id="data-wrangling" class="level3" data-number="8.8.2"><h3 data-number="8.8.2" class="anchored" data-anchor-id="data-wrangling">
<span class="header-section-number">8.8.2</span> Data Wrangling</h3>
<p>To prepare the dataset:</p>
<ul>
<li><p><strong>Handling Missing Data:</strong> If borrowers have missing credit scores or income values, we must decide whether to impute them (mean, median, regression-based) or drop those cases. Missingness should be checked systematically.</p></li>
<li><p><strong>Encoding Categorical Variables:</strong> Variables like <code>married</code> and <code>owns_home</code> need to be encoded as 0/1 indicators. In R and Python, logistic regression functions handle factors/dummies automatically, but it’s important to confirm coding.</p></li>
<li>
<p><strong>Dealing with Class Imbalance:</strong> Loan defaults are usually much rarer than non-defaults. A dataset with 90% non-defaults and 10% defaults might lead a model to always predict “no default” and still achieve 90% accuracy. Strategies include:</p>
<ul>
<li>Adjusting the decision threshold (not always 0.5),</li>
<li>Using resampling methods (oversampling defaults, undersampling non-defaults), or</li>
<li>Applying class weights in the model.</li>
</ul>
</li>
<li><p><strong>Splitting Data for Training/Testing:</strong> To fairly assess predictive performance, we split the dataset into <strong>training</strong> (used to fit the model) and <strong>testing</strong> (used to evaluate it). A common split is 70/30. This prevents overfitting and ensures the model generalizes to new borrowers.</p></li>
</ul>
<hr>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Check for missing values and document how they were handled.</li>
<li>Ensure categorical variables (<code>married</code>, <code>owns_home</code>) are encoded properly.</li>
<li>Assess class balance in <code>defaulted</code> and consider strategies if imbalance is severe.</li>
<li>Split dataset into training and test sets, keeping class balance in mind.</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check missing data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Encode categorical variables (ensure they are factors)</span></span>
<span><span class="va">BLR</span> <span class="op">&lt;-</span> <span class="va">BLR</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    married <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">married</span><span class="op">)</span>,</span>
<span>    owns_home <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">owns_home</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Check class balance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">defaulted</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">defaulted</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split into training/testing sets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">trainIndex</span> <span class="op">&lt;-</span> <span class="fu">createDataPartition</span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">defaulted</span>, p <span class="op">=</span> <span class="fl">.7</span>, list <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">BLR</span><span class="op">[</span> <span class="va">trainIndex</span>, <span class="op">]</span></span>
<span><span class="va">test</span>  <span class="op">&lt;-</span> <span class="va">BLR</span><span class="op">[</span><span class="op">-</span><span class="va">trainIndex</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check missing data</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode categorical variables</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'married'</span>] <span class="op">=</span> df[<span class="st">'married'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'owns_home'</span>] <span class="op">=</span> df[<span class="st">'owns_home'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check class balance</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'defaulted'</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into train/test sets (stratify to preserve class balance)</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>train, test <span class="op">=</span> train_test_split(df, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                               stratify<span class="op">=</span>df[<span class="st">'defaulted'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="exploratory-data-analysis-eda" class="level2" data-number="8.9"><h2 data-number="8.9" class="anchored" data-anchor-id="exploratory-data-analysis-eda">
<span class="header-section-number">8.9</span> Exploratory Data Analysis (EDA)</h2>
<p>Before fitting a logistic regression, we need to understand the structure of our data. Exploratory analysis helps us spot patterns, distributions, and potential issues.</p>
<section id="classifying-variables" class="level3" data-number="8.9.1"><h3 data-number="8.9.1" class="anchored" data-anchor-id="classifying-variables">
<span class="header-section-number">8.9.1</span> Classifying Variables</h3>
<p>Our dataset contains predictors such as <code>credit_score</code>, <code>income</code>, <code>education_years</code>, <code>married</code>, <code>owns_home</code>, and <code>age</code>. The response variable <code>defaulted</code> is binary (<code>0</code> = no default, <code>1</code> = default).</p>
</section><section id="visualizing-distributions" class="level3" data-number="8.9.2"><h3 data-number="8.9.2" class="anchored" data-anchor-id="visualizing-distributions">
<span class="header-section-number">8.9.2</span> Visualizing Distributions</h3>
<ul>
<li>
<strong>Continuous predictors</strong> (e.g., credit score, income) can be visualized with histograms or density plots, split by default status.</li>
<li>
<strong>Categorical predictors</strong> (e.g., married, owns_home) can be compared with barplots of default rates.</li>
</ul></section><section id="exploring-relationships-with-binary-outcome" class="level3" data-number="8.9.3"><h3 data-number="8.9.3" class="anchored" data-anchor-id="exploring-relationships-with-binary-outcome">
<span class="header-section-number">8.9.3</span> Exploring Relationships with Binary Outcome</h3>
<p>Boxplots or violin plots of credit score by default status, or barplots of default rates by home ownership, help reveal potential predictors. Correlations among continuous predictors can also be checked to watch for multicollinearity.</p>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Plot distribution of credit scores for defaulters vs non-defaulters.</li>
<li>Plot default rates by categorical predictors (<code>married</code>, <code>owns_home</code>).</li>
<li>Correlation heatmap for continuous predictors.</li>
<li>Summarize key EDA takeaways (e.g., lower credit scores → higher default rates).</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Boxplot of credit score by default</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">BLR</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">defaulted</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">credit_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Defaulted"</span>, y <span class="op">=</span> <span class="st">"Credit Score"</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Credit Score Distribution by Default Status"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Barplot of default by home ownership</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">BLR</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">owns_home</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">defaulted</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Owns Home"</span>, y <span class="op">=</span> <span class="st">"Proportion"</span>, </span>
<span>       fill <span class="op">=</span> <span class="st">"Defaulted"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Default Rates by Home Ownership"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correlation heatmap</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/wiki/ggcorrplot-visualization-of-a-correlation-matrix-using-ggplot2">ggcorrplot</a></span><span class="op">)</span></span>
<span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"credit_score"</span>,<span class="st">"income"</span>,<span class="st">"education_years"</span>,<span class="st">"age"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggcorrplot/man/ggcorrplot.html">ggcorrplot</a></span><span class="op">(</span><span class="va">corr</span>, lab <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot credit score by default</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"defaulted"</span>, y<span class="op">=</span><span class="st">"credit_score"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Credit Score Distribution by Default Status"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Barplot default by home ownership</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">"owns_home"</span>, y<span class="op">=</span><span class="st">"defaulted"</span>, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Default Rates by Home Ownership"</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation heatmap</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>,<span class="st">'education_years'</span>,<span class="st">'age'</span>]].corr()</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Correlation Heatmap of Continuous Predictors"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="data-modelling" class="level2" data-number="8.10"><h2 data-number="8.10" class="anchored" data-anchor-id="data-modelling">
<span class="header-section-number">8.10</span> Data Modelling</h2>
<p>With EDA complete, we’re ready to specify our logistic regression model.</p>
<section id="choosing-a-logistic-regression-model" class="level3" data-number="8.10.1"><h3 data-number="8.10.1" class="anchored" data-anchor-id="choosing-a-logistic-regression-model">
<span class="header-section-number">8.10.1</span> Choosing a Logistic Regression Model</h3>
<p>The response variable is binary: <code>defaulted ∈ {0,1}</code>. Logistic regression is appropriate because it ensures predictions stay between 0 and 1.</p>
</section><section id="defining-modeling-parameters" class="level3" data-number="8.10.2"><h3 data-number="8.10.2" class="anchored" data-anchor-id="defining-modeling-parameters">
<span class="header-section-number">8.10.2</span> Defining Modeling Parameters</h3>
<ul>
<li>
<strong>Response Variable (Y):</strong> <code>defaulted</code> (1 = default, 0 = no default).</li>
<li>
<strong>Predictors (X):</strong> Key predictors like <code>credit_score</code> and <code>income</code>. Categorical variables (e.g., <code>married</code>) can be included as factors/dummies.</li>
</ul></section><section id="setting-up-the-logistic-regression-equation" class="level3" data-number="8.10.3"><h3 data-number="8.10.3" class="anchored" data-anchor-id="setting-up-the-logistic-regression-equation">
<span class="header-section-number">8.10.3</span> Setting Up the Logistic Regression Equation</h3>
<p>The logistic regression model is:</p>
<p><span class="math display">\[
\log\left(\frac{p_i}{1 - p_i}\right) = \beta_0 + \beta_1 \cdot \text{credit\_score}_i + \beta_2 \cdot \text{income}_i + \cdots
\]</span></p>
<p>where <span class="math inline">\(p_i\)</span> is the probability that customer <span class="math inline">\(i\)</span> defaults.</p>
<p>This means coefficients describe changes in the <strong>log-odds of default</strong> for a one-unit change in the predictor, holding other predictors constant.</p>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Write down the full logistic regression equation for your chosen predictors.</li>
<li>Decide whether categorical variables should be included (dummy-coded).</li>
<li>Check multicollinearity before finalizing model.</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fit base model</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span> <span class="va">owns_home</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>,<span class="st">'married'</span>,<span class="st">'owns_home'</span>]]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y, X).fit()</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logit_model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="estimation" class="level2" data-number="8.11"><h2 data-number="8.11" class="anchored" data-anchor-id="estimation">
<span class="header-section-number">8.11</span> Estimation</h2>
<p>Once the model is specified, we need to estimate its parameters. Unlike OLS, which minimizes squared errors, logistic regression uses <strong>Maximum Likelihood Estimation (MLE)</strong>.</p>
<section id="maximum-likelihood-estimation" class="level3" data-number="8.11.1"><h3 data-number="8.11.1" class="anchored" data-anchor-id="maximum-likelihood-estimation">
<span class="header-section-number">8.11.1</span> Maximum Likelihood Estimation</h3>
<p>MLE finds the coefficients that maximize the probability of observing the data we actually have. Intuitively, the model adjusts coefficients until the predicted probabilities align as closely as possible with observed defaults.</p>
</section><section id="fitting-the-model-in-practice" class="level3" data-number="8.11.2"><h3 data-number="8.11.2" class="anchored" data-anchor-id="fitting-the-model-in-practice">
<span class="header-section-number">8.11.2</span> Fitting the Model in Practice</h3>
<p>In practice, estimation is done using iterative numerical algorithms (e.g., Newton-Raphson). Software (R, Python) handles this behind the scenes, but it’s important to understand that coefficients are chosen to maximize the likelihood, not minimize error.</p>
<p>For our loan dataset, fitting the model gives us coefficients for credit score, income, and other predictors. These are the estimates we’ll later test and interpret.</p>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Report log-likelihood value for the fitted model.</li>
<li>Show convergence message (iteration process).</li>
<li>Provide estimated coefficients with standard errors.</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Logistic regression fit</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span> <span class="co"># shows estimates, SE, z, p-values, log-likelihood</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y, X).fit()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(logit_model.summary())  <span class="co"># includes estimates, SE, z, p-values, log-likelihood</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="inference" class="level2" data-number="8.12"><h2 data-number="8.12" class="anchored" data-anchor-id="inference">
<span class="header-section-number">8.12</span> Inference</h2>
<p>After estimating a logistic regression model, we often want to know whether predictors are <strong>statistically significant</strong> — i.e., whether they have a meaningful relationship with the probability of default. In logistic regression, inference is based on the <strong>likelihood framework</strong>.</p>
<section id="wald-tests" class="level3" data-number="8.12.1"><h3 data-number="8.12.1" class="anchored" data-anchor-id="wald-tests">
<span class="header-section-number">8.12.1</span> Wald Tests</h3>
<p>The <strong>Wald test</strong> checks whether an individual coefficient is significantly different from zero. For example, we can test whether <code>credit_score</code> has a nonzero effect on the odds of default. The test statistic is the ratio of the estimated coefficient to its standard error.</p>
</section><section id="likelihood-ratio-tests" class="level3" data-number="8.12.2"><h3 data-number="8.12.2" class="anchored" data-anchor-id="likelihood-ratio-tests">
<span class="header-section-number">8.12.2</span> Likelihood Ratio Tests</h3>
<p>We can also compare <strong>nested models</strong> (e.g., model with <code>credit_score</code> only vs.&nbsp;model with <code>credit_score + income</code>) using the <strong>likelihood ratio (LR) test</strong>. This evaluates whether adding predictors significantly improves model fit.</p>
</section><section id="confidence-intervals" class="level3" data-number="8.12.3"><h3 data-number="8.12.3" class="anchored" data-anchor-id="confidence-intervals">
<span class="header-section-number">8.12.3</span> Confidence Intervals</h3>
<p>Finally, we often report <strong>confidence intervals for odds ratios</strong>. For example, if the odds ratio for credit score is 0.99 with a 95% CI [0.98, 0.995], we can say with confidence that higher credit scores reduce the odds of default.</p>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Wald test output for credit score and income.</li>
<li>Likelihood ratio test comparing one- vs.&nbsp;two-predictor models.</li>
<li>Confidence intervals for odds ratios, reported in plain language.</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Logistic regression</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Wald test results are included in summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confidence intervals for odds ratios</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Likelihood ratio test for nested models</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span>, data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">logit_model</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> r.data[<span class="st">'BLR'</span>].copy()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>X_full <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]])</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>model_full <span class="op">=</span> sm.Logit(y, X_full).fit()</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test (coeff / SE)</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>wald_stats <span class="op">=</span> (model_full.params <span class="op">/</span> model_full.bse)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Wald test chi2 values:</span><span class="ch">\n</span><span class="st">"</span>, wald_stats)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence intervals for odds ratios</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>conf <span class="op">=</span> model_full.conf_int()</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="op">=</span> np.exp(model_full.params)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>conf_exp <span class="op">=</span> np.exp(conf)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Odds Ratios:</span><span class="ch">\n</span><span class="st">"</span>, pd.DataFrame({<span class="st">"OR"</span>: odds_ratios,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"2.5%"</span>: conf_exp[<span class="dv">0</span>],</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"97.5%"</span>: conf_exp[<span class="dv">1</span>]}))</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test vs simpler model</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>X_simple <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>]])</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>model_simple <span class="op">=</span> sm.Logit(y, X_simple).fit()</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>LR_stat <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (model_full.llf <span class="op">-</span> model_simple.llf)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>df_diff <span class="op">=</span> model_full.df_model <span class="op">-</span> model_simple.df_model</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> chi2.sf(LR_stat, df_diff)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"LR Test: chi2=</span><span class="sc">{</span>LR_stat<span class="sc">:.2f}</span><span class="ss">, df=</span><span class="sc">{</span>df_diff<span class="sc">}</span><span class="ss">, p=</span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="coefficient-interpretation" class="level2" data-number="8.13"><h2 data-number="8.13" class="anchored" data-anchor-id="coefficient-interpretation">
<span class="header-section-number">8.13</span> Coefficient Interpretation</h2>
<p>Once we’ve established that predictors matter, the next step is to <strong>interpret the coefficients</strong> in a meaningful way.</p>
<section id="odds-ratios-and-their-meaning" class="level3" data-number="8.13.1"><h3 data-number="8.13.1" class="anchored" data-anchor-id="odds-ratios-and-their-meaning">
<span class="header-section-number">8.13.1</span> Odds Ratios and Their Meaning</h3>
<p>Logistic regression coefficients are expressed in <strong>log-odds units</strong>. To make them interpretable, we exponentiate them to obtain <strong>odds ratios</strong>.</p>
<ul>
<li>Example: If the coefficient for credit score is -0.01, the odds ratio is about 0.99.</li>
<li>Interpretation: each 1-point increase in credit score reduces the odds of default by about 1%.</li>
</ul>
<p>Scaling makes interpretation clearer:</p>
<ul>
<li>A <strong>50-point increase</strong> in credit score reduces the odds of default by roughly 40%.</li>
<li>For income, if the odds ratio is 1.00001, it means that each additional dollar increases odds only slightly — so we might instead interpret per <strong>$10,000 increase</strong>.</li>
</ul></section><section id="pitfalls-in-interpretation" class="level3" data-number="8.13.2"><h3 data-number="8.13.2" class="anchored" data-anchor-id="pitfalls-in-interpretation">
<span class="header-section-number">8.13.2</span> Pitfalls in Interpretation</h3>
<p>It’s important to remember that odds ratios are <strong>multiplicative</strong>, not additive. This means the effect on probability depends on the baseline. For example:</p>
<ul>
<li>Going from a 40% chance of default to 30% is a big shift,</li>
<li>But the same odds ratio may translate into a much smaller change if the baseline probability is already low (e.g., from 5% to 4%).</li>
</ul>
<p>Clear communication requires translating odds ratios back into <strong>probability changes</strong> for meaningful scenarios.</p>
</section><section id="example-from-loan-default-dataset" class="level3" data-number="8.13.3"><h3 data-number="8.13.3" class="anchored" data-anchor-id="example-from-loan-default-dataset">
<span class="header-section-number">8.13.3</span> Example from Loan Default Dataset</h3>
<p>Suppose our model finds:</p>
<ul>
<li>OR for credit score = 0.99 → each point decrease in odds of default by 1%.</li>
<li>OR for income = 0.95 per $10,000 → higher income slightly reduces default risk.</li>
</ul>
<p>We can then present this in plain English:</p>
<blockquote class="blockquote">
<p>“A borrower with a credit score of 700 has about a 10% chance of default, but with a score of 600, their probability rises to nearly 30%, holding income constant.”</p>
</blockquote>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Report odds ratios with 95% CI for credit score and income.</li>
<li>Translate coefficients into real-world terms (per 50-point change in credit score, per $10k change in income).</li>
<li>Add figure showing predicted probability curve vs.&nbsp;credit score.</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Logistic regression</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Odds ratios and CI</span></span>
<span><span class="va">odds_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">odds_ratios</span></span>
<span></span>
<span><span class="co"># Example: probability at credit_score = 600 vs 700</span></span>
<span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>credit_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">700</span><span class="op">)</span>,</span>
<span>                       income <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">income</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, newdata <span class="op">=</span> <span class="va">new_data</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Odds ratios</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> model_full.params</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>conf <span class="op">=</span> model_full.conf_int()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="op">=</span> np.exp(params)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>conf_exp <span class="op">=</span> np.exp(conf)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.DataFrame({<span class="st">"OR"</span>: odds_ratios,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"2.5%"</span>: conf_exp[<span class="dv">0</span>],</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"97.5%"</span>: conf_exp[<span class="dv">1</span>]}))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: probability at 600 vs 700 credit score</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"const"</span>: <span class="dv">1</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"credit_score"</span>: [<span class="dv">600</span>, <span class="dv">700</span>],</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"income"</span>: [df[<span class="st">'income'</span>].mean(), df[<span class="st">'income'</span>].mean()]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model_full.predict(test_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="predictions" class="level2" data-number="8.14"><h2 data-number="8.14" class="anchored" data-anchor-id="predictions">
<span class="header-section-number">8.14</span> Predictions</h2>
<p>Once we’ve fit a logistic regression model, we can use it to generate <strong>predicted probabilities</strong> of default for each customer. These probabilities fall between 0 and 1 and tell us how likely the model thinks it is that a customer will default given their predictors.</p>
<section id="predicted-probabilities-vs.-predicted-classes" class="level3" data-number="8.14.1"><h3 data-number="8.14.1" class="anchored" data-anchor-id="predicted-probabilities-vs.-predicted-classes">
<span class="header-section-number">8.14.1</span> Predicted Probabilities vs.&nbsp;Predicted Classes</h3>
<p>Predicted probabilities can be turned into <strong>class predictions</strong> (default vs.&nbsp;no default) by applying a threshold, usually 0.5. Customers with probability ≥ 0.5 are classified as “default,” and those below as “no default.”</p>
<p>But in practice, the choice of threshold matters. If we lower the threshold to 0.3, we’ll catch more actual defaulters (higher <strong>sensitivity</strong>) but at the cost of more false alarms (lower <strong>specificity</strong>).</p>
</section><section id="evaluating-performance" class="level3" data-number="8.14.2"><h3 data-number="8.14.2" class="anchored" data-anchor-id="evaluating-performance">
<span class="header-section-number">8.14.2</span> Evaluating Performance</h3>
<p>To judge prediction quality, we use metrics such as:</p>
<ul>
<li>
<strong>Accuracy:</strong> proportion of correct predictions.</li>
<li>
<strong>Sensitivity (recall):</strong> proportion of true defaults correctly identified.</li>
<li>
<strong>Specificity:</strong> proportion of true non-defaults correctly identified.</li>
<li>
<strong>ROC curve &amp; AUC:</strong> performance across all thresholds, not just one.</li>
</ul>
<p>For our loan dataset, we might find that the model predicts non-defaults very well (high specificity) but misses some defaults (lower sensitivity). This trade-off is a central theme in logistic regression applications.</p>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Insert confusion matrix for the loan dataset at threshold 0.5.</li>
<li>Add ROC curve and report AUC.</li>
<li>Discuss trade-offs between sensitivity and specificity with an example.</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Logistic regression model</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predictions</span></span>
<span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_prob</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confusion matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="fu">confusionMatrix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_class</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">defaulted</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ROC curve</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span><span class="va">roc_curve</span> <span class="op">&lt;-</span> <span class="fu">roc</span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">defaulted</span>, <span class="va">BLR</span><span class="op">$</span><span class="va">pred_prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">roc_curve</span>, main<span class="op">=</span><span class="st">"ROC Curve for Loan Default Model"</span><span class="op">)</span></span>
<span><span class="fu">auc</span><span class="op">(</span><span class="va">roc_curve</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, classification_report, roc_curve, auc</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> r.data[<span class="st">'BLR'</span>].copy()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y, X).fit()</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'pred_prob'</span>] <span class="op">=</span> logit_model.predict(X)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'pred_class'</span>] <span class="op">=</span> (df[<span class="st">'pred_prob'</span>] <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix &amp; metrics</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y, df[<span class="st">'pred_class'</span>]))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y, df[<span class="st">'pred_class'</span>]))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC curve</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresholds <span class="op">=</span> roc_curve(y, df[<span class="st">'pred_prob'</span>])</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>roc_auc <span class="op">=</span> auc(fpr, tpr)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, label<span class="op">=</span><span class="ss">f"AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,<span class="dv">1</span>], [<span class="dv">0</span>,<span class="dv">1</span>], linestyle<span class="op">=</span><span class="st">"--"</span>, color<span class="op">=</span><span class="st">"grey"</span>)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"False Positive Rate"</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"True Positive Rate"</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"ROC Curve for Loan Default Model"</span>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="goodness-of-fit-model-selection" class="level2" data-number="8.15"><h2 data-number="8.15" class="anchored" data-anchor-id="goodness-of-fit-model-selection">
<span class="header-section-number">8.15</span> Goodness of Fit &amp; Model Selection</h2>
<p>Evaluating whether our model is a “good” fit is just as important as making predictions. For logistic regression, the diagnostics differ from OLS.</p>
<section id="pseudo-r-squared-measures" class="level3" data-number="8.15.1"><h3 data-number="8.15.1" class="anchored" data-anchor-id="pseudo-r-squared-measures">
<span class="header-section-number">8.15.1</span> Pseudo R-Squared Measures</h3>
<p>Because we don’t have the same notion of variance explained as in OLS, we use <strong>pseudo R² measures</strong> (e.g., McFadden’s R²). These are useful for comparison, but don’t carry the same interpretation as R² in linear regression.</p>
</section><section id="analysis-of-deviance" class="level3" data-number="8.15.2"><h3 data-number="8.15.2" class="anchored" data-anchor-id="analysis-of-deviance">
<span class="header-section-number">8.15.2</span> Analysis of Deviance</h3>
<p>We can compare models using the <strong>deviance</strong> statistic, which measures how well the model fits relative to a saturated model. Lower deviance indicates better fit. Nested models (e.g., one with <code>credit_score</code> only vs.&nbsp;one with <code>credit_score + income</code>) can be compared using a likelihood ratio test.</p>
</section><section id="information-criteria" class="level3" data-number="8.15.3"><h3 data-number="8.15.3" class="anchored" data-anchor-id="information-criteria">
<span class="header-section-number">8.15.3</span> Information Criteria</h3>
<p>Another approach is to use <strong>information criteria</strong> such as:</p>
<ul>
<li><strong>AIC (Akaike Information Criterion)</strong></li>
<li><strong>BIC (Bayesian Information Criterion)</strong></li>
</ul>
<p>Both balance fit and complexity: lower AIC or BIC means a better trade-off. AIC tends to favor more complex models; BIC penalizes complexity more heavily.</p>
<p>For the loan default dataset, we might find that adding <code>income</code> improves fit according to AIC but not BIC, suggesting we need to decide between <strong>predictive accuracy</strong> and <strong>parsimony</strong>.</p>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Report pseudo R² for the loan model.</li>
<li>Compare single-predictor vs.&nbsp;two-predictor models with deviance test.</li>
<li>Report AIC and BIC values.</li>
<li>Provide plain-language interpretation (e.g., “Adding income slightly improves model fit”).</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fit models</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span>, data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare deviance (likelihood ratio test)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pseudo R-squared</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atahk/pscl">pscl</a></span><span class="op">)</span></span>
<span><span class="fu">pR2</span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># AIC and BIC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> r.data[<span class="st">'BLR'</span>].copy()</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1: credit score only</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>]])</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> sm.Logit(df[<span class="st">'defaulted'</span>], X1).fit()</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 2: credit score + income</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]])</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> sm.Logit(df[<span class="st">'defaulted'</span>], X2).fit()</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>LR_stat <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (model2.llf <span class="op">-</span> model1.llf)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>df_diff <span class="op">=</span> model2.df_model <span class="op">-</span> model1.df_model</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> chi2.sf(LR_stat, df_diff)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Likelihood Ratio Test:"</span>, LR_stat, <span class="st">"df:"</span>, df_diff, <span class="st">"p:"</span>, p_value)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC &amp; BIC</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model 1 AIC/BIC:"</span>, model1.aic, model1.bic)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model 2 AIC/BIC:"</span>, model2.aic, model2.bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="model-diagnostics" class="level2" data-number="8.16"><h2 data-number="8.16" class="anchored" data-anchor-id="model-diagnostics">
<span class="header-section-number">8.16</span> Model Diagnostics</h2>
<p>Once we’ve estimated our logistic regression model, it’s important to check whether the model is <strong>well-specified</strong> and whether there are any <strong>problematic observations</strong> influencing the results. Diagnostics help us assess whether our predictions are trustworthy and whether model assumptions are being violated.</p>
<section id="deviance-residuals" class="level3" data-number="8.16.1"><h3 data-number="8.16.1" class="anchored" data-anchor-id="deviance-residuals">
<span class="header-section-number">8.16.1</span> Deviance Residuals</h3>
<p>In logistic regression, we don’t have “raw residuals” like in OLS. Instead, we use <strong>deviance residuals</strong>, which measure how far off each predicted probability is from the actual outcome. Large residuals may indicate observations the model struggles to predict — for instance, a borrower with a very high credit score who still defaulted.</p>
<p>Plotting deviance residuals can help detect such outliers.</p>
</section><section id="binned-residual-plots" class="level3" data-number="8.16.2"><h3 data-number="8.16.2" class="anchored" data-anchor-id="binned-residual-plots">
<span class="header-section-number">8.16.2</span> Binned Residual Plots</h3>
<p>Another way to check fit is with <strong>binned residual plots</strong>. Here, predicted probabilities are grouped (binned), and we compare average predicted probabilities with observed default rates in each bin. A well-calibrated model should show points lying close to the diagonal line (predicted = observed).</p>
<p>For our loan dataset, if the model predicts a 20% default rate for customers in a bin, then about 20% of those customers should actually have defaulted.</p>
</section><section id="detecting-influential-points" class="level3" data-number="8.16.3"><h3 data-number="8.16.3" class="anchored" data-anchor-id="detecting-influential-points">
<span class="header-section-number">8.16.3</span> Detecting Influential Points</h3>
<p>Finally, some individual cases may <strong>exert outsized influence</strong> on the model — often measured using statistics like <strong>Cook’s distance</strong> or <strong>leverage</strong>. For example, a single customer with an unusually low credit score but very high income may skew the coefficient estimates. Identifying such cases ensures that no single observation is disproportionately driving conclusions.</p>
<hr>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Add plot of deviance residuals vs.&nbsp;predicted probabilities.</li>
<li>Add binned residual plot for calibration.</li>
<li>Add influence plot (highlighting high-leverage or influential cases).</li>
<li>Provide a short interpretation using the loan default dataset.</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Logistic regression model</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Deviance residuals</span></span>
<span><span class="va">residuals_dev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">logit_model</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot deviance residuals vs. predicted probabilities</span></span>
<span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_prob</span>, <span class="va">residuals_dev</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Predicted Probability"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Deviance Residuals"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Deviance Residuals vs Predicted Probability"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Binned residual plot (using arm package)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span></span>
<span><span class="fu">binnedplot</span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_prob</span>, <span class="va">residuals_dev</span>,</span>
<span>           xlab <span class="op">=</span> <span class="st">"Predicted Probability"</span>,</span>
<span>           ylab <span class="op">=</span> <span class="st">"Average Residual"</span>,</span>
<span>           main <span class="op">=</span> <span class="st">"Binned Residual Plot"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Influence measures</span></span>
<span><span class="va">influence_measures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">influence.measures</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">influence_measures</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> r.data[<span class="st">'BLR'</span>].copy()</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]])</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y, X).fit()</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'pred_prob'</span>] <span class="op">=</span> logit_model.predict(X)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Deviance residuals (via statsmodels residuals)</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>resid_dev <span class="op">=</span> logit_model.resid_dev</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot deviance residuals vs predicted probabilities</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>plt.scatter(df[<span class="st">'pred_prob'</span>], resid_dev, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Predicted Probability"</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Deviance Residuals"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Deviance Residuals vs Predicted Probability"</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>sm.graphics.influence_plot(logit_model, criterion<span class="op">=</span><span class="st">"cooks"</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="results" class="level2" data-number="8.17"><h2 data-number="8.17" class="anchored" data-anchor-id="results">
<span class="header-section-number">8.17</span> Results</h2>
<p>Once we’ve fit our logistic regression model, the next step is to <strong>present the results</strong>. Results can be organized into two complementary perspectives:</p>
<ol type="1">
<li>
<strong>Predictive Analysis</strong> — How well does our model classify customers into “default” vs.&nbsp;“non-default”?</li>
<li>
<strong>Inferential Analysis</strong> — What do the model’s coefficients tell us about the relationship between predictors (e.g., credit score, income) and the probability of default?</li>
</ol>
<section id="predictive-analysis" class="level3" data-number="8.17.1"><h3 data-number="8.17.1" class="anchored" data-anchor-id="predictive-analysis">
<span class="header-section-number">8.17.1</span> Predictive Analysis</h3>
<p>From a predictive standpoint, the model provides <strong>predicted probabilities</strong> for each customer. By applying a threshold (commonly 0.5), we can classify customers as predicted to default or not.</p>
<p>We then evaluate performance using:</p>
<ul>
<li>
<strong>Accuracy:</strong> The proportion of correct predictions.</li>
<li>
<strong>Sensitivity (Recall):</strong> How well the model detects actual defaults.</li>
<li>
<strong>Specificity:</strong> How well the model detects non-defaults.</li>
<li>
<strong>ROC Curve / AUC:</strong> Performance across all possible thresholds.</li>
</ul>
<p>For example, in our loan dataset, the model correctly classifies a high proportion of non-defaulters, but sensitivity may be lower if defaults are relatively rare.</p>
</section><section id="inferential-analysis" class="level3" data-number="8.17.2"><h3 data-number="8.17.2" class="anchored" data-anchor-id="inferential-analysis">
<span class="header-section-number">8.17.2</span> Inferential Analysis</h3>
<p>From an inferential perspective, the coefficients give us <strong>odds ratios</strong> that describe how predictors affect default risk.</p>
<p>For instance, a coefficient of <code>-0.01</code> for credit score corresponds to an <strong>odds ratio of 0.99</strong> — meaning that for every 1-point increase in credit score, the odds of defaulting decrease by about 1%. Scaled up, a <strong>50-point increase</strong> lowers the odds by roughly 40%.</p>
<p>By converting odds ratios into <strong>changes in probability</strong> at meaningful ranges of credit score, we provide a more intuitive interpretation for readers.</p>
<hr>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Insert table summarizing model coefficients with odds ratios and confidence intervals.</li>
<li>Add classification table (confusion matrix) showing accuracy, sensitivity, specificity.</li>
<li>Include ROC curve for predictive storytelling.</li>
<li>Provide plain-language interpretation of at least one coefficient (credit score).</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Fit logistic regression model</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary for inference</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Odds ratios with confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">logit_model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predictive evaluation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="va">pred_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">pred_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">pred_prob</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">confusionMatrix</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">pred_class</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">defaulted</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ROC curve</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span><span class="va">roc_curve</span> <span class="op">&lt;-</span> <span class="fu">roc</span><span class="op">(</span><span class="va">BLR</span><span class="op">$</span><span class="va">defaulted</span>, <span class="va">pred_prob</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">roc_curve</span>, main<span class="op">=</span><span class="st">"ROC Curve for Loan Default Model"</span><span class="op">)</span></span>
<span><span class="fu">auc</span><span class="op">(</span><span class="va">roc_curve</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, classification_report, roc_curve, auc</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> r.data[<span class="st">'BLR'</span>].copy()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]])</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y, X).fit()</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Inference: odds ratios</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> logit_model.params</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>conf <span class="op">=</span> logit_model.conf_int()</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="op">=</span> pd.DataFrame({</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"OR"</span>: params.<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.exp(x)),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2.5%"</span>: conf[<span class="dv">0</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.exp(x)),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"97.5%"</span>: conf[<span class="dv">1</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.exp(x))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(odds_ratios)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'pred_prob'</span>] <span class="op">=</span> logit_model.predict(X)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'pred_class'</span>] <span class="op">=</span> (df[<span class="st">'pred_prob'</span>] <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix &amp; report</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y, df[<span class="st">'pred_class'</span>]))</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y, df[<span class="st">'pred_class'</span>]))</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC Curve</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresholds <span class="op">=</span> roc_curve(y, df[<span class="st">'pred_prob'</span>])</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>roc_auc <span class="op">=</span> auc(fpr, tpr)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="ss">f'ROC curve (AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.2f}</span><span class="ss">)'</span>)</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,<span class="dv">1</span>], [<span class="dv">0</span>,<span class="dv">1</span>], color<span class="op">=</span><span class="st">'grey'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"ROC Curve for Loan Default Model"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"False Positive Rate"</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"True Positive Rate"</span>)</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>)</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<hr></section></section><section id="storytelling" class="level2" data-number="8.18"><h2 data-number="8.18" class="anchored" data-anchor-id="storytelling">
<span class="header-section-number">8.18</span> Storytelling</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Effective storytelling connects statistical results to real-world meaning. Translate log-odds into “lenders are X times more likely to…” language.</p>
</div>
</div>
<p>The final step of our analysis is not just running the model, but <strong>communicating the findings</strong> clearly. Logistic regression results are often presented to stakeholders like lenders, policy makers, or managers, who may not be trained in statistics. For them, <strong>the story matters more than the math.</strong></p>
<p>Let’s revisit our loan default dataset. Suppose our logistic regression showed that <strong>credit score</strong> is strongly predictive of default:</p>
<ul>
<li>A 50-point increase in credit score reduces the odds of defaulting by about 40%.</li>
<li>In probability terms, this means that increasing credit score from 400 to 450 lowers the chance of default from roughly 70% to about 50%.</li>
</ul>
<p>Notice how we moved from the technical language of <strong>odds ratios</strong> to a <strong>plain-language probability story</strong>. This makes the model’s results accessible to a wider audience.</p>
<p>Visuals amplify the story:</p>
<ul>
<li>A plot of predicted probabilities vs.&nbsp;credit score shows the <strong>smooth S-shaped curve</strong> replacing the jagged OLS line.</li>
<li>A confusion matrix or ROC curve shows how well our model actually classifies defaulters.</li>
<li>Calibration plots show whether predicted probabilities line up with observed rates of default.</li>
</ul>
<p>Finally, good storytelling means acknowledging limitations. For example, our dataset may suffer from <strong>class imbalance</strong> (fewer defaults than non-defaults), which could bias results. We should be clear about what the model can and cannot do.</p>
<p><strong>TODOs for this section:</strong></p>
<ul>
<li>Add figure of predicted probabilities vs.&nbsp;actual defaults (using <code>credit_score</code>).</li>
<li>Show a ROC curve for the loan default model.</li>
<li>Add plain-language interpretations of coefficients (esp.&nbsp;odds ratio for <code>credit_score</code>).</li>
<li>Add a note about limitations (e.g., income and education may be correlated with credit score).</li>
</ul>
<hr>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R Code</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Python Code</a></li>
</ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Logistic regression on loan default data</span></span>
<span><span class="va">logit_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">defaulted</span> <span class="op">~</span> <span class="va">credit_score</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">BLR</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predicted probabilities</span></span>
<span><span class="va">BLR</span><span class="op">$</span><span class="va">pred_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">logit_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Storytelling visualization</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">BLR</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">credit_score</span>, y <span class="op">=</span> <span class="va">pred_prob</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">defaulted</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Predicted Probability of Default vs. Credit Score"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Credit Score"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Predicted Probability"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Actual Default"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract loan default data</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> r.data[<span class="st">'BLR'</span>].copy()</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'defaulted'</span>] <span class="op">=</span> df[<span class="st">'defaulted'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit logistic regression</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(df[[<span class="st">'credit_score'</span>,<span class="st">'income'</span>]])</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'defaulted'</span>]</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>logit_model <span class="op">=</span> sm.Logit(y, X).fit()</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'pred_prob'</span>] <span class="op">=</span> logit_model.predict(X)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Storytelling visualization</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> ax.scatter(df[<span class="st">'credit_score'</span>], df[<span class="st">'pred_prob'</span>],</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>                     c<span class="op">=</span>df[<span class="st">'defaulted'</span>], cmap<span class="op">=</span><span class="st">'coolwarm'</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Predicted Probability of Default vs. Credit Score"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Credit Score"</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Predicted Probability"</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>legend1 <span class="op">=</span> ax.legend(<span class="op">*</span>scatter.legend_elements(), title<span class="op">=</span><span class="st">"Actual Default"</span>)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>ax.add_artist(legend1)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/alexrod61\.github\.io\/regression-cookbook\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "alexrod61/regression-cookbook";
    script.dataset.repoId = "R_kgDOMSJoUA";
    script.dataset.category = "General";
    script.dataset.categoryId = "";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../book/discrete-zone.html" class="pagination-link" aria-label="Discrete Cuisine">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Discrete Cuisine</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../book/09-binomial-logistic.html" class="pagination-link" aria-label="Cheesified Binomial Logistic Regression">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Cheesified Binomial Logistic Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025; G. Alexi Rodríguez-Arelis, Andy Tai, and Ben Chen</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/alexrod61/regression-cookbook/edit/main/book/08-binary-logistic.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/alexrod61/regression-cookbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/alexrod61/regression-cookbook/blob/main/book/08-binary-logistic.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>